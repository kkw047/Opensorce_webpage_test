<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title th:text="${club.name} + ' - 게시판'">게시판</title>
    <link rel="stylesheet" th:href="@{/css/app.css}">
    <style>
        /* (임시) 콘텐츠 카드 스타일 */
        .detail-card { border: 1px solid #1a332c; border-radius: 14px; background: #0f231e; padding: 16px; margin-bottom: 16px; }
    </style>
</head>
<body class="bg-deep">

<header class="topbar" th:replace="~{fragments/common :: topbar}"></header>

<div class="wrap">
    <aside class="sidebar" th:replace="~{fragments/common :: sidebar}"></aside>

    <main class="content">
        <form class="toolbar" th:replace="~{fragments/common :: searchbar}"></form>

        <div class="detail-card">
            <div th:replace="~{fragments/common :: club-tabs}"></div>
        </div>
        <h1 th:text="${club.name} + ' - 게시판'">게시판</h1>

        <div class="post-grid-container">

            <div class="post-card" th:each="post : ${postList}">

                <div class="card-header">
                    <img th:src="@{/images/profile-default.png}"
                         alt="프로필 이미지" class="profile-thumb">

                    <div class="author-info">
                        <span class="author-name" th:text="${post.author.nickname}">홍길동</span>
                        <span class="post-date" th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}">2023-10-27</span>
                    </div>
                </div>

                <div class="card-content">
                    <h3 class="post-title">
                        <a th:href="@{/clubs/{clubId}/board/{postId}(clubId=${club.id}, postId=${post.id})}" th:text="${post.title}">
                            게시물 제목이 여기에 들어갑니다.
                        </a>
                    </h3>

                    <p class="post-preview" th:text="${post.content}">
                        글 내용의 미리보기가 여기에 표시됩니다. 길면 두 줄 정도로 잘려야 합니다.
                    </p>
                </div>

            </div>

            <div th:if="${#lists.isEmpty(postList)}" class="no-posts-message">
                아직 작성된 게시물이 없습니다.
            </div>

        </div>
        <div style="text-align: right; margin-top: 16px;">
            <a th:href="@{/clubs/{clubId}/board/new(clubId=${club.id})}" class="btn btn-primary">
                글쓰기
            </a>
        </div>

    </main>
</div>

<div th:replace="~{fragments/common :: modals}"></div>

<div th:replace="~{fragments/common :: scripts}"></div>

<div id="toast"
     th:if="${error != null or msg != null}"
     th:text="${error ?: msg}"
     class="toast show">
</div>

<script th:if="${openLogin}">
    document.addEventListener("DOMContentLoaded", () => modal("loginModal", true));
</script>
<script th:if="${openRegister}">
    document.addEventListener("DOMContentLoaded", () => modal("registerModal", true));
</script>

</body>
</html>