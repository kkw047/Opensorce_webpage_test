<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>모임 목록</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; }
        header { display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid #eee; }
        nav a { margin-right:12px; text-decoration:none; color:#333; padding:6px 10px; border-radius:8px; }
        nav a.active { background:#111; color:#fff; }
        .container { display:grid; grid-template-columns: 260px 1fr; gap:20px; padding:20px 16px; max-width:1200px; margin:0 auto; }
        aside { border:1px solid #eee; border-radius:12px; padding:16px; }
        main { min-height: 60vh; }
        .grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap:16px; }
        .card { border:1px solid #eee; border-radius:12px; padding:14px; }
        .muted { color:#666; font-size:13px; }
        .title { font-weight:700; margin:0 0 6px; }
        .desc { color:#444; font-size:14px; margin:6px 0 0; line-height:1.5; }
        .badge { display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; border:1px solid #ddd; color:#333; }
        .toolbar { display:flex; align-items:center; gap:8px; margin-bottom:14px; }
        .pagination { display:flex; gap:6px; margin-top:16px; }
        .pagination a, .pagination span { padding:6px 10px; border-radius:8px; border:1px solid #eee; text-decoration:none; color:#333; }
        .pagination .current { background:#111; color:#fff; border-color:#111; }
        .field { margin-bottom:10px; }
        .field label { display:block; font-size:13px; color:#555; margin-bottom:6px; }
        select, input[type="text"] { width:100%; padding:8px 10px; border:1px solid #ddd; border-radius:8px; }
        .chips { display:flex; flex-wrap:wrap; gap:6px; margin-top:8px; }
    </style>
</head>
<body>
<header>
    <div style="font-weight:800">Team11</div>
    <nav>
        <!-- #httpServletRequest 를 쓰지 않고, 컨트롤러에서 내려준 activeMenu 로만 처리 -->
        <a href="/clubs" th:classappend="${activeMenu}=='clubs' ? ' active' : ''">모임</a>
        <a href="/about" th:classappend="${activeMenu}=='about' ? ' active' : ''">소개</a>
    </nav>
</header>

<div class="container">
    <aside>
        <h3 style="margin:0 0 10px;">필터</h3>

        <form method="get" th:action="@{/clubs}">
            <div class="field">
                <label for="regionDo">지역(도)</label>
                <select id="regionDo" name="regionDo">
                    <option th:value="" th:selected="${regionDo == null or regionDo == ''}">전체</option>
                    <option th:each="doItem : ${regionDoList}"
                            th:value="${doItem}"
                            th:text="${doItem}"
                            th:selected="${doItem == regionDo}">충청북도</option>
                </select>
            </div>

            <div class="field">
                <label for="category">카테고리</label>
                <select id="category" name="category">
                    <option th:value="" th:selected="${category == null or category == ''}">전체</option>
                    <option th:each="c : ${categories}"
                            th:value="${c.id}"
                            th:text="${c.name}"
                            th:selected="${c.id == ${category}}">스포츠</option>
                </select>
            </div>

            <div class="field">
                <label for="kw">키워드(쉼표 구분)</label>
                <input id="kw" type="text" name="keywords"
                       th:value="${keywords != null} ? ${#strings.arrayJoin(keywords, ', ')} : ''"
                       placeholder="예) 축구,주말,청주"/>
                <div class="muted">예: <code>축구, 주말</code></div>
            </div>

            <div class="field">
                <label for="size">페이지 크기</label>
                <select id="size" name="size">
                    <option th:value="6" th:selected="${size == 6}">6</option>
                    <option th:value="9" th:selected="${size == 9}">9</option>
                    <option th:value="12" th:selected="${size == 12}">12</option>
                    <option th:value="20" th:selected="${size == 20}">20</option>
                </select>
            </div>

            <input type="hidden" name="page" th:value="${page}" />
            <button type="submit" style="width:100%; padding:10px 12px; border:0; border-radius:10px; background:#111; color:#fff;">
                적용
            </button>
        </form>
    </aside>

    <main>
        <div class="toolbar">
            <div class="muted"
                 th:text="|총 ${clubsPage.totalElements}개 / ${clubsPage.totalPages}페이지|">총 0개</div>
        </div>

        <div class="grid">
            <div class="card" th:each="club : ${clubsPage.content}">
                <div class="title" th:text="${club.name}">모임 이름</div>
                <div class="chips">
                    <span class="badge" th:text="${club.regionDo} ?: '지역미지정'">충북</span>
                    <span class="badge" th:text="${club.regionSi} ?: ''">청주</span>
                </div>
                <p class="desc" th:text="${club.description} ?: '설명이 아직 없습니다.'">설명</p>
            </div>
        </div>

        <div class="pagination" th:if="${clubsPage.totalPages > 1}">
            <!-- 이전 -->
            <span th:if="${clubsPage.first}" aria-disabled="true">이전</span>
            <a th:if="${!clubsPage.first}"
               th:href="@{/clubs(page=${clubsPage.number-1},size=${size},regionDo=${regionDo},regionSi=${regionSi},category=${category},keywords=${keywords})}">이전</a>

            <!-- 페이지 번호 -->
            <span th:each="i : ${#numbers.sequence(0, clubsPage.totalPages-1)}"
                  th:classappend="${i} == ${clubsPage.number} ? 'current' : ''"
                  th:text="${i+1}"
                  th:if="${i >= (clubsPage.number-2) and i <= (clubsPage.number+2)}"
                  th:remove="tag">
            </span>

            <!-- 다음 -->
            <span th:if="${clubsPage.last}" aria-disabled="true">다음</span>
            <a th:if="${!clubsPage.last}"
               th:href="@{/clubs(page=${clubsPage.number+1},size=${size},regionDo=${regionDo},regionSi=${regionSi},category=${category},keywords=${keywords})}">다음</a>
        </div>
    </main>
</div>
</body>
</html>
